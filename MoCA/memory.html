<!doctype html>
<html>
  <head>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="../jspsych.js"></script>
    <script src="../plugins/jspsych-text.js"></script>
    <script src="../plugins/jspsych-single-stim.js"></script>
    <script src="../MoCA_plugins/tutorial1.js"></script>
    <link rel="stylesheet" href="css/jquery-ui.css"/>
    <link rel="stylesheet" href="../css/jspsych.css"/>
    <style>
      img { width: 300px; }
      .largeText {
          font-weight: bold;
        font-size: 400%;
      }
    </style>
  </head>
  <body>
    <div id="MoCA-target"></div>
  </body>
  <script>
    /* define welcome message block */
    var welcome_block = {
      type: "text",
      text: "Welcome to the experiment. Press any key to begin."
    };

    /* define instructions block */
    var instructions_block = {
      type: "text",
      text: "<p>In this experiment, a circle will appear in the center " +
          "of the screen.</p><p>If the circle is <strong>blue</strong>, " +
          "press the letter F on the keyboard as fast as you can.</p>" +
          "<p>If the circle is <strong>orange</strong>, do not press " +
          "any key.</p>" +
          "<div class='left center-content'><img src='img/blue.png'/>" +
          "<p class='small'><strong>Press the F key</strong></p></div>" +
          "<div class='right center-content'><img src='img/orange.png'/>" +
          "<p class='small'><strong>Do not press a key</strong></p></div>" +
          "<p>Press any key to begin.</p>",
      timing_post_trial: 2000
    };

    /* define test block */

    var test_stimuli = [
      {
        image: "img/blue.png",
        data: { response: 'go' }
      },
      {
        image: "img/orange.png",
        data: { response: 'no-go' }
      }
    ];

    var all_trials = jsPsych.randomization.repeat(test_stimuli, 10, true);

    var post_trial_gap = function() {
      return Math.floor( Math.random() * 1500 ) + 750;
    }

/*    var test_block = {
      type: "single-stim",
      stimuli: all_trials.image,
      choices: ['F'],
      data: all_trials.data,
      timing_response: 1500,
      timing_post_trial: post_trial_gap
    };*/

    trialLetters = []
trialLetters.push('<span class="largeText">j</span>')
trialLetters.push('<span class="largeText">u</span>')
trialLetters.push('<span class="largeText">b</span>')
trialLetters.push('<span class="largeText">j</span>')
trialLetters.push('<span class="largeText">i</span>')
trialLetters.push('<span class="largeText">s</span>')
trialLetters.push('<span class="largeText">x</span>')
trialLetters.push('<span class="largeText">a</span>')
trialLetters.push('<span class="largeText">s</span>')
trialLetters.push('<span class="largeText">t</span>')
/*trialLetters.push('<span class="largeText">z')
trialLetters.push('<span class="largeText">q')
trialLetters.push('<span class="largeText">f')
trialLetters.push('<span class="largeText">k')
trialLetters.push('<span class="largeText">g')
trialLetters.push('<span class="largeText">p')
trialLetters.push('<span class="largeText">k')
trialLetters.push('<span class="largeText">h')
trialLetters.push('<span class="largeText">w')
trialLetters.push('<span class="largeText">z')
trialLetters.push('<span class="largeText">m')
trialLetters.push('<span class="largeText">l')
trialLetters.push('<span class="largeText">z')
trialLetters.push('<span class="largeText">p')
trialLetters.push('<span class="largeText">c')
trialLetters.push('<span class="largeText">r')
trialLetters.push('<span class="largeText">p')
trialLetters.push('<span class="largeText">x')
trialLetters.push('<span class="largeText">e')
trialLetters.push('<span class="largeText">w')
trialLetters.push('<span class="largeText">x')
trialLetters.push('<span class="largeText">q')
trialLetters.push('<span class="largeText">h')
trialLetters.push('<span class="largeText">o')
trialLetters.push('<span class="largeText">p')
trialLetters.push('<span class="largeText">w')
trialLetters.push('<span class="largeText">j')
trialLetters.push('<span class="largeText">r')
trialLetters.push('<span class="largeText">e')
trialLetters.push('<span class="largeText">d')
trialLetters.push('<span class="largeText">g')
trialLetters.push('<span class="largeText">e')
trialLetters.push('<span class="largeText">c')
trialLetters.push('<span class="largeText">q')
trialLetters.push('<span class="largeText">b')
trialLetters.push('<span class="largeText">t')
trialLetters.push('<span class="largeText">q')
trialLetters.push('<span class="largeText">i')
trialLetters.push('<span class="largeText">k')
trialLetters.push('<span class="largeText">a')
trialLetters.push('<span class="largeText">s')
trialLetters.push('<span class="largeText">x')
trialLetters.push('<span class="largeText">a')
trialLetters.push('<span class="largeText">v')
trialLetters.push('<span class="largeText">m')
trialLetters.push('<span class="largeText">z')
trialLetters.push('<span class="largeText">l')
trialLetters.push('<span class="largeText">a')
trialLetters.push('<span class="largeText">g')
trialLetters.push('<span class="largeText">l')
trialLetters.push('<span class="largeText">z')
trialLetters.push('<span class="largeText">w')*/
/*trialLetters.push('u')
trialLetters.push('z')
trialLetters.push('p')
trialLetters.push('l')
trialLetters.push('r')
trialLetters.push('m')
trialLetters.push('t')
trialLetters.push('j')
trialLetters.push('q')
trialLetters.push('k')
trialLetters.push('o')
trialLetters.push('q')
trialLetters.push('x')
trialLetters.push('f')
trialLetters.push('d')
trialLetters.push('x')
trialLetters.push('a')
trialLetters.push('s')
trialLetters.push('e')
trialLetters.push('u')
trialLetters.push('p')
trialLetters.push('e')
trialLetters.push('x')
trialLetters.push('i')
trialLetters.push('v')
trialLetters.push('z')
trialLetters.push('c')
trialLetters.push('k')
trialLetters.push('o')
trialLetters.push('l')
trialLetters.push('d')
trialLetters.push('o')
trialLetters.push('u')
trialLetters.push('b')
trialLetters.push('j')
trialLetters.push('m')
trialLetters.push('r')
trialLetters.push('e')
trialLetters.push('g')
trialLetters.push('a')
trialLetters.push('e')
trialLetters.push('z')
trialLetters.push('w')
trialLetters.push('h')
trialLetters.push('p')
trialLetters.push('w')
trialLetters.push('q')
trialLetters.push('f')
trialLetters.push('s')
trialLetters.push('q')
trialLetters.push('h')
trialLetters.push('w')
trialLetters.push('j')
trialLetters.push('q')
trialLetters.push('v')
trialLetters.push('j')
trialLetters.push('a')
trialLetters.push('d')
trialLetters.push('k')
trialLetters.push('a')*/

    var test_block = {
    type: 'single-stim',
    stimuli: trialLetters,
    is_html: true,
    timing_response: 1500,
        choices: ['a'], // space bar
    response_ends_trial: false
}

    /* define debrief block */

    function getAverageResponseTime() {

      var trials = jsPsych.data.getTrialsOfType('single-stim');

      var sum_rt = 0;
      var valid_trial_count = 0;
      for (var i = 0; i < trials.length; i++) {
        if (trials[i].response == 'go' && trials[i].rt > -1) {
          sum_rt += trials[i].rt;
          valid_trial_count++;
        }
      }
      return Math.floor(sum_rt / valid_trial_count);
    }

    var debrief_block = {
      type: "text",
      text: function() {
        return "<p>Your average response time was <strong>" +
        getAverageResponseTime() + "ms</strong>. Press " +
        "any key to complete the experiment. Thank you!</p>";
      }
    };

    /* create experiment definition array */
    var experiment = [];
    experiment.push(welcome_block);
    experiment.push(instructions_block);
    experiment.push(test_block);
    experiment.push(debrief_block);

    /* start the experiment */
    jsPsych.init({
      experiment_structure: experiment,
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });
  </script>
</html>
